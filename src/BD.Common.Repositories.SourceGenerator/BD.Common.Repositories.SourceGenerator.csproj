<Project Sdk="Microsoft.NET.Sdk">
	<Import Project="..\GeneratePackage.props" />

	<PropertyGroup>
		<TargetFramework>netstandard2.0</TargetFramework>
		<PackageTags>BeyondDimension Common CommonRepositories Repositories SourceGenerator</PackageTags>
		<Description>$(Product)</Description>
		<EnforceExtendedAnalyzerRules>true</EnforceExtendedAnalyzerRules>
		<IsRoslynComponent>true</IsRoslynComponent>
		<ImplicitUsings>enable</ImplicitUsings>
		<CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
		<DefineConstants>SOURCE_GENERATOR;$(DefineConstants)</DefineConstants>
		<IncludeBuildOutput>false</IncludeBuildOutput>
		<NoPackageAnalysis>true</NoPackageAnalysis>
		<EmbedUntrackedSources>false</EmbedUntrackedSources>
		<IncludeSymbols>false</IncludeSymbols>
	</PropertyGroup>

	<ItemGroup>
		<Compile Remove="..\AssemblyInfo.cs"></Compile>
		<Compile Remove="..\ImplicitUsings.Common.cs"></Compile>
		<Compile Include="..\BD.Common.Repositories.SourceGenerator.Annotations\*.cs">
			<LinkBase>Annotations</LinkBase>
		</Compile>
		<Compile Include="..\BD.Common.Settings.V4.SourceGenerator\IndexRange.cs">
			<LinkBase>Compat</LinkBase>
		</Compile>
		<Compile Include="..\BD.Common.Settings.V4.SourceGenerator\IsExternalInit.cs">
			<LinkBase>Compat</LinkBase>
		</Compile>
		<Compile Include="..\BD.Common\Extensions\StreamExtensions.ToByteArray.cs">
			<LinkBase>Extensions</LinkBase>
		</Compile>
		<Compile Include="..\BD.Common\Extensions\StreamExtensions.Write.cs">
			<LinkBase>Extensions</LinkBase>
		</Compile>
		<Compile Include="..\BD.Common\Extensions\StreamExtensions.Format.cs">
			<LinkBase>Extensions</LinkBase>
		</Compile>
		<Compile Include="..\BD.Common\Extensions\StringExtensions.Trim.cs">
			<LinkBase>Extensions</LinkBase>
		</Compile>
		<Compile Include="..\BD.Common\Extensions\StringExtensions.NumberLetter.cs">
			<LinkBase>Extensions</LinkBase>
		</Compile>
		<!--<Compile Include="..\Translate.cs">
			<LinkBase>Helpers</LinkBase>
		</Compile>-->
		<Compile Include="..\Utils.cs">
			<LinkBase>Helpers</LinkBase>
		</Compile>
	</ItemGroup>

	<ItemGroup>
		<!--<PackageReference Include="System.Text.Json" />-->
		<PackageReference Include="Newtonsoft.Json" />
		<PackageReference Include="Humanizer.Core.zh-CN" />
	</ItemGroup>

	<ItemGroup>
		<PackageReference Include="Microsoft.CodeAnalysis.Analyzers">
			<PrivateAssets>all</PrivateAssets>
			<IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
		</PackageReference>
		<PackageReference Include="Microsoft.CodeAnalysis.CSharp" PrivateAssets="all" />
	</ItemGroup>

	<!-- ðŸ‘‡ Add a new target that runs before the task that lists all the files to include in the NuGet package.
          This task must run after the packages resolution target -->
	<Target Name="AddNuGetDlls" BeforeTargets="_GetPackageFiles">
		<ItemGroup>
			<!-- Update the collection of items to pack with the DLLs from the NuGet packages -->
			<None Include="$(OutputPath)\Newtonsoft.Json.dll" Pack="true" PackagePath="analyzers/dotnet/cs" Visible="false" />
			<None Include="$(OutputPath)\Humanizer.dll" Pack="true" PackagePath="analyzers/dotnet/cs" Visible="false" />
			<None Include="$(OutputPath)\zh-CN\Humanizer.resources.dll" Pack="true" PackagePath="analyzers/dotnet/cs/zh-CN" Visible="false" />

			<!-- Add the DLL produced by the current project to the NuGet package -->
			<None Include="$(OutputPath)\$(AssemblyName).dll" Pack="true" PackagePath="analyzers/dotnet/cs" Visible="false" />
		</ItemGroup>
	</Target>

</Project>
